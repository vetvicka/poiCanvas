// Generated by CoffeeScript 1.3.3
(function() {
  var animate, calcX, calcY, degToRad, drawPoi;

  $(function() {
    var x, y;
    window.context = document.getElementById("canvasArea").getContext("2d");
    window.canvas = document.getElementById("canvasArea");
    window.canvas.width = window.innerWidth - 350;
    window.canvas.height = window.innerHeight - 8;
    window.armLen = 50;
    window.poiLen = 50;
    window.poiABeats = -3;
    window.poiBBeats = -3;
    window.armBDirection = false;
    window.armADirection = false;
    window.showHands = true;
    window.showTrails = true;
    window.poiAShift = 0;
    window.poiBShift = 180;
    window.poiARotation = 0;
    window.poiBRotation = 0;
    x = Math.round(window.canvas.width / 2);
    y = Math.round(window.canvas.height / 2);
    return window.canvasData = {
      x: x,
      y: y,
      pos: 0,
      speed: 1
    };
  });

  $(function() {
    return $(window).resize(function() {
      window.canvas.width = window.innerWidth - 350;
      window.canvas.height = window.innerHeight - 8;
      window.canvasData.x = Math.round(window.canvas.width / 2);
      return window.canvasData.y = Math.round(window.canvas.height / 2);
    });
  });

  degToRad = function(deg) {
    return (deg * 2 * Math.PI) / 360;
  };

  $(function() {
    return setInterval(animate, 21);
  });

  calcX = function(origin, deg, poi) {
    return origin + poi.armLen * Math.sin(degToRad(poi.rotation) + degToRad(deg)) + poi.poiLen * Math.sin(poi.beats * (degToRad(deg)));
  };

  calcY = function(origin, deg, poi) {
    return origin + poi.armLen * Math.cos(degToRad(poi.rotation) + degToRad(deg)) + poi.poiLen * Math.cos(poi.beats * (degToRad(deg)));
  };

  drawPoi = function(poi) {
    var breaker, ctx, i, linePos, x, x0, y, y0, _i, _j, _ref, _ref1;
    x0 = window.canvasData.x;
    y0 = window.canvasData.y;
    ctx = window.context;
    if (window.showHands === true) {
      ctx.beginPath();
      x = window.canvasData.x;
      y = window.canvasData.y;
      ctx.arc(x, y, poi.armLen, 0, Math.PI * 2);
      ctx.lineWidth = 0.5;
      ctx.strokeStyle = "#cacaca";
      ctx.stroke();
    }
    if (window.showTrails === true) {
      ctx.beginPath();
      ctx.lineWidth = 0.5;
      for (i = _i = 0; _i <= 360; i = ++_i) {
        x = calcX(x0, i, poi);
        y = calcY(y0, i, poi);
        ctx.lineTo(x, y);
        ctx.strokeStyle = poi.poiColor;
      }
      ctx.stroke();
    }
    if (window.showHands === true) {
      ctx.beginPath();
      x = x0 + poi.armLen * Math.sin(degToRad(poi.rotation) + degToRad(poi.fromDeg));
      y = y0 + poi.armLen * Math.cos(degToRad(poi.rotation) + degToRad(poi.fromDeg));
      ctx.arc(x, y, 7, 0, Math.PI * 2);
      ctx.fillStyle = "brown";
      ctx.fill();
      ctx.beginPath();
      ctx.moveTo(x, y);
      x = calcX(x0, poi.fromDeg, poi);
      y = calcY(y0, poi.fromDeg, poi);
      ctx.lineTo(x, y);
      ctx.stroke();
    }
    x = calcX(x0, poi.fromDeg, poi);
    y = calcY(y0, poi.fromDeg, poi);
    ctx.beginPath();
    ctx.arc(x, y, 7, 0, Math.PI * 2);
    ctx.fillStyle = poi.poiColor;
    ctx.fill();
    linePos = 91;
    breaker = 0;
    ctx.beginPath();
    for (i = _j = _ref = poi.fromDeg, _ref1 = poi.toDeg; _ref <= _ref1 ? _j <= _ref1 : _j >= _ref1; i = _ref <= _ref1 ? ++_j : --_j) {
      x = calcX(x0, i, poi);
      y = calcY(y0, i, poi);
      ctx.lineTo(x, y);
      ctx.strokeStyle = poi.poiColor;
      ctx.lineWidth = 10 * (linePos-- / 90);
      if (breaker % 7 === 0) {
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
      }
      breaker += 1;
    }
    return ctx.stroke();
  };

  animate = function() {
    var ctx, oldPos, poiA, poiB, pos, x0, y0;
    x0 = 500;
    y0 = 500;
    ctx = window.context;
    ctx.clearRect(0, 0, window.canvas.width, window.canvas.height);
    pos = window.canvasData.pos;
    poiA = {
      fromDeg: pos + 90 + window.poiAShift,
      toDeg: pos + window.poiAShift,
      poiColor: "Red",
      beats: window.poiABeats,
      showPath: true,
      rotation: window.poiARotation,
      showHand: true,
      armLen: window.canvas.height / 4 * (window.armLen / 100),
      poiLen: window.canvas.height / 4 * (window.poiLen / 100)
    };
    poiB = {
      fromDeg: pos + 90 + window.poiBShift,
      toDeg: pos + window.poiBShift,
      poiColor: "Green",
      beats: window.poiBBeats,
      showPath: true,
      rotation: window.poiBRotation,
      showHand: true,
      armLen: window.canvas.height / 4 * (window.armLen / 100),
      poiLen: window.canvas.height / 4 * (window.poiLen / 100)
    };
    if (window.armADirection) {
      poiA.fromDeg = 360 - pos + window.poiAShift;
      poiA.toDeg = 360 - pos + 90 + window.poiAShift;
    }
    if (window.armBDirection) {
      poiB.fromDeg = 360 - pos + window.poiBShift;
      poiB.toDeg = 360 - pos + 90 + window.poiBShift;
    }
    drawPoi(poiA);
    drawPoi(poiB);
    oldPos = window.canvasData.pos;
    return window.canvasData.pos = (pos + 0.5 + window.canvasData.speed) % 360;
  };

}).call(this);
